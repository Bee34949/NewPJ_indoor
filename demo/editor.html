<!-- File: demo/editor.html -->
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>IndoorMap – Nodes/POIs Editor</title>
  <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.css"/>
  <style>
    html,body{height:100%;margin:0;font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,TH Sarabun New,Noto Sans Thai;}
    #app{display:grid;grid-template-columns:360px 1fr;height:100%;}
    #sidebar{overflow:auto;background:#0f172a;color:#e2e8f0}
    .panel{padding:10px;border-bottom:1px solid #334155}
    h2{font-size:16px;margin:6px 0 10px;font-weight:700}
    label{display:block;font-size:12px;color:#cbd5e1;margin-top:8px}
    input,select,textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #475569;background:#0b1220;color:#e2e8f0}
    textarea{min-height:64px;resize:vertical}
    .row{display:flex;gap:8px}
    .row>div{flex:1}
    button{padding:8px 10px;border-radius:8px;border:1px solid #475569;background:#1e293b;color:#e5e7eb;cursor:pointer}
    button.primary{background:#2563eb;border-color:#1d4ed8}
    button.danger{background:#b91c1c;border-color:#7f1d1d}
    .chips{display:flex;flex-wrap:wrap;gap:6px;margin-top:6px}
    .chip{padding:4px 10px;border-radius:999px;border:1px solid #475569;background:#0b1220;cursor:pointer}
    .chip.active{background:#0ea5e9;border-color:#0284c7}
    .list{max-height:180px;overflow:auto;border:1px solid #334155;border-radius:8px;margin-top:8px}
    .item{padding:6px 8px;border-bottom:1px dashed #334155;cursor:pointer}
    .item.active{background:#0b1220}
    #map{width:100%;height:100%}
    .legend{display:flex;gap:10px;align-items:center;font-size:12px}
    .dot{display:inline-block;width:10px;height:10px;border-radius:50%}
    .toast{position:fixed;top:10px;left:50%;transform:translateX(-50%);background:#111827;color:#fff;padding:8px 12px;border-radius:8px;z-index:9999}
    .muted{color:#94a3b8;font-size:12px}
  </style>
</head>
<body>
<div id="app">
  <aside id="sidebar">
    <div class="panel">
      <h2>ไฟล์ข้อมูล</h2>
      <div class="row">
        <button id="btn-load-pois">โหลดจากเซิร์ฟเวอร์</button>
        <button id="btn-import-pois">นำเข้าไฟล์…</button>
      </div>
      <div class="row" style="margin-top:6px">
        <button id="btn-save-pois" class="primary">Export .geojson</button>
        <button id="btn-save-nodes">Export nodes.geojson</button>
      </div>
      <div class="muted" style="margin-top:6px">ปลายทางไฟล์บนเซิร์ฟเวอร์: <code>demo/dist/_tmp/*.geojson</code></div>
    </div>

    <div class="panel">
      <h2>ค้นหา/กรอง</h2>
      <input id="q" placeholder="ค้นหา: id / ชื่อ / หมวด…"/>
      <div class="row">
        <select id="filter-floor">
          <option value="">ทุกชั้น</option>
        </select>
        <select id="filter-cat">
          <option value="">ทุกหมวด</option>
          <option>door</option><option>lift</option><option>stairs</option>
          <option>restroom</option><option>cafe</option><option>food</option>
          <option>office</option><option>classroom</option><option>lab</option><option>printer</option><option>exit</option>
        </select>
      </div>
      <div class="list" id="result"></div>
    </div>

    <div class="panel">
      <h2>รายละเอียดโหนด/POI</h2>
      <div class="row">
        <div>
          <label>ID</label><input id="f-id" placeholder="ถ้าเว้นว่าง → สร้าง UUID"/>
        </div>
        <div>
          <label>ชั้น (Floor)</label><input id="f-floor" placeholder="01"/>
        </div>
      </div>
      <div class="row">
        <div>
          <label>ชนิด (kind / type)</label>
          <select id="f-kind">
            <option value="poi">poi</option>
            <option value="door">door</option>
            <option value="lift">lift</option>
            <option value="stairs">stairs</option>
            <option value="junction">junction</option>
          </select>
        </div>
        <div>
          <label>หมวดหมู่ (POI)</label><input id="f-cats" placeholder="คอมมา , เช่น cafe,food"/>
        </div>
      </div>
      <label>ชื่อ (EN)</label><input id="f-name"/>
      <label>ชื่อ (TH)</label><input id="f-name-th"/>
      <label>Aliases</label><input id="f-aliases" placeholder="เช่น N170, ห้อง 4A-107"/>
      <label>เวลาเปิด (open_hours / JSON หรือ 08:00-17:00)</label><input id="f-hours"/>
      <label>Metadata (JSON)</label><textarea id="f-meta" placeholder='{"note":"..."}'></textarea>
      <div class="row" style="margin-top:8px">
        <button id="btn-save-item" class="primary">บันทึกการแก้ไข</button>
        <button id="btn-del-item" class="danger">ลบ</button>
        <button id="btn-uuid">สร้าง UUID</button>
      </div>
    </div>

    <div class="panel">
      <h2>เพิ่มโหนด/POI</h2>
      <div class="row">
        <select id="new-kind">
          <option value="poi">poi</option><option value="door">door</option>
          <option value="lift">lift</option><option value="stairs">stairs</option><option value="junction">junction</option>
        </select>
        <button id="btn-add-point" class="primary">โหมดเพิ่ม: คลิกบนแผนที่</button>
      </div>
      <div class="muted" style="margin-top:6px">คลิกแผนที่เพื่อวางจุด, กดปุ่มอีกครั้งเพื่อออกจากโหมด</div>
    </div>

    <div class="panel">
      <div class="legend">
        <span><i class="dot" style="background:#2563eb"></i> door</span>
        <span><i class="dot" style="background:#16a34a"></i> lift</span>
        <span><i class="dot" style="background:#fb923c"></i> stairs</span>
        <span><i class="dot" style="background:#94a3b8"></i> poi</span>
      </div>
    </div>
    <div class="panel muted">Auto-save ลง <code>localStorage</code> ทุกครั้งที่แก้ไข</div>
  </aside>

  <div id="map"></div>
</div>

<script src="https://unpkg.com/maplibre-gl@3.6.2/dist/maplibre-gl.js"></script>
<script type="module" src="./js/editor.js"></script>
</body>
</html>
